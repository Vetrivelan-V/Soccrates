<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">

<head>
    <title>Apache Tomcat WebSocket Examples: Chat</title>
    <!-- Latest compiled and minified CSS -->

    <style type="text/css">
        <![CDATA[ input#chat {
            width: 410px;
            margin-left: 35%;
            padding: 10px;
        }

        #console-container {
            width: 100%;
        }

        #console {
            border: 1px solid #CCCCCC;

            height: 700px;
			overflow:auto;
            padding: 5px;
            /*width: 100%;*/
            margin-top: 10px;
        }

        #console p {
            padding: 0;
            margin: 0;
        }

        .fastreload {
            border: none;
            padding: 10px;
            background: #1967be;
            color: #fff;
            margin-left: 39%;
        }
        option
        {
        background: #fff;
        color: #000;
        }
select
{
padding: 7px;
    border: none;
    border-radius: 4px;
    background: #337ab7;
    color:#fff;
    width:180px;
    border: 1px solid #efefef;
    outline: none;}
        .updaterate {
            border: none;
            padding: 10px;
            background: #1967be;
            color: #fff;
        }

        .modal-header {
		padding:8px 30px!important;
            background: #3379c7;
            color: #fff;
            border-bottom: none!important;
        }
		.checkbox, .radio
		{
		padding:8px;
		}
		#timerange
		{
		display:none;
		}
		#daterange
		{
		display:none;
		}
		.checkbox-inline, .radio-inline
		{
		margin-bottom:15px!important;
		}
		.btncontainer{
		width:75%;
		}
		.heading
		{
		margin:50px;
		}
        ]]>
    </style>


<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet"/>
<link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel = "stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js" ></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js" type="text/javascript" ></script>
<script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
      


<script>
$(document).ready(function(){
  
    $("#daily").click(function(){
        $("#timerange").show();
		$("#weekrange").hide();
		$("#daterange").hide();
		$('#scheduler').unbind('click');
		$("#scheduler").click(function(){
			var time = $("#timevalue").val();
			var schedulardata = {
			jobID : "2",
			dateString  :"",
			timeString :time
			};
			if(time==null || time=="")
			{
			alert("Please select time")
			}
				else{
			$.ajax({
            url: 'https://qa.taxometry.com/CarsService/idmts/scheduler_settings_ws/scheduler_settings',
            type: 'post',
			data:JSON.stringify(schedulardata),
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
               console.log("data")
			   alert("Scheduling Successfull");
				window.location.reload();
			   
            },
            //data: JSON.stringify(person)
        });
			}
		 });



    });
	    $("#weekly").click(function(){
		$("#timevalue").val("")
        $("#weekrange").show();
		$("#timerange").show();
		$("#daterange").hide();
		$('#scheduler').unbind('click');
		$("#scheduler").click(function(){
			var time = $("#timevalue").val();
			var day = $("#weekoption").val();
			var schedulardata = {
			jobID : "2",
			dateString  :"",
			timeString :time
			};
			if(day ==0)
			{
			alert("Please select day");
			}
			if(time==null || time=="")
			{
			alert("Please select time")
			}
				else{
			$.ajax({
            url: 'https://qa.taxometry.com/CarsService/idmts/scheduler_settings_ws/scheduler_settings',
            type: 'post',
			data:JSON.stringify(schedulardata),
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
               console.log("data")
			   alert("Scheduling Successfull");
				window.location.reload();
			   
            },
            //data: JSON.stringify(person)
        });
			}
			
		 });
    });
	    $("#monthly").click(function(){
		$("#timevalue").val("")
		$("#datepicker-3").val("")
		$("#weekrange").hide();
        $("#timerange").show();
		$("#daterange").show();
		//$("#scheduler").value("");
		$('#scheduler').unbind('click');
		$("#scheduler").click(function(){
			var date = $("#datepicker-3").val();
			var time = $("#timevalue").val();
			console.log("date",date)
			console.log("time",time)
			var schedulardata = {
			jobID : "2",
			dateString  :date,
			timeString :time
			};
			if(date==null || date=="")
			{
			alert("Please select date")
			}
			if(time==null || time=="" )
			{
			alert("Please select time")
			}
			else{
			$.ajax({
            url: 'https://qa.taxometry.com/CarsService/idmts/scheduler_settings_ws/scheduler_settings',
            type: 'post',
			data:JSON.stringify(schedulardata),
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
               console.log("data")
			   alert("Scheduling Successfull");
				window.location.reload();
			   
            },
            //data: JSON.stringify(person)
        });
			}
		 });
		
    });
	   $("#yearly").click(function(){
	   		$("#timevalue").val("")
		$("#datepicker-3").val("")
		$("#weekrange").hide();
        $("#timerange").show();
		$("#daterange").show();
		//$("#scheduler").value("");
		$('#scheduler').unbind('click');
		$("#scheduler").click(function(){
			var date = $("#datepicker-3").val();
			var time = $("#timevalue").val();
			var schedulardata = {
			jobID : "2",
			dateString  :date,
			timeString :time
			};
			if(date==null || date=="")
			{
			alert("Please select date")
			}
			if(time==null || time=="" )
			{
			alert("Please select time")
			}
				else{
				
			$.ajax({
            url: 'https://qa.taxometry.com/CarsService/idmts/scheduler_settings_ws/scheduler_settings',
            type: 'post',
			data:JSON.stringify(schedulardata),
            dataType: 'json',
            contentType: 'application/json',
            success: function (data) {
               console.log("data")
			   alert("Scheduling Successfull");
				window.location.reload();
			   
            },
            //data: JSON.stringify(person)
        });
			}
		 });
    });
	
});

</script>
  <script>
         $(document).ready(function(){
            $( "#datepicker-3" ).datepicker({
               
               dateFormat:"mm-dd-yy",
               altField: "#datepicker-4",
               altFormat: "DD, d MM, yy"
            });
         });
		 $(function () {
                $('#datetimepicker3').datetimepicker({
				
                    format: 'HH:mm:ss',
					
					
                });
            });

      </script>
    <script type="application/javascript">
        <![CDATA[
            "use strict";

        var Chat = {};

        Chat.socket = null;

        Chat.connect = (function (host) {
            if ('WebSocket' in window) {
                Chat.socket = new WebSocket('ws://qa.taxometry.com:8080/service/websocket/chat');
				//Chat.socket = new WebSocket("ws://qa.taxometry.com/service/websocket/chat");
            } else if ('MozWebSocket' in window) {
                Chat.socket = new MozWebSocket(host);
            } else {
                Console.log('Error: WebSocket is not supported by this browser.');
                return;
            }

            Chat.socket.onopen = function () {
                //Console.log('Info: WebSocket connection opened.');
              //  document.getElementById('chat').onkeydown = function (event) {
                   // if (event.keyCode == 13) {
                       // Chat.sendMessage();
                   // }
                //};
                
                window.test = function(e) {
  if (e.value === 'Force Rates') {
	   Chat.socket.send("{commandCode:10001}");
  } else if (e.value === 'Force Boundary') {
	  Chat.socket.send("{commandCode:10010}");
  } 
  else if (e.value === 'Force TaxMatrix') {
	  Chat.socket.send("{commandCode:10100}");
  }
  else if (e.value === 'Rates') {
	  Chat.socket.send("{commandCode:20001}");
  }
  else if (e.value === 'Boundary') {
	  Chat.socket.send("{commandCode:20010}");
  }
  else if (e.value === 'TaxMatrix') {
	  Chat.socket.send("{commandCode:20100}");
  }
}
            };

            Chat.socket.onclose = function () {
                document.getElementById('chat').onkeydown = null;
                Console.log('Info: WebSocket closed.');
				
            };

            Chat.socket.onmessage = function (message) {
				var response = {};
				this.response = JSON.parse(message.data);
				if(this.response.currentStatus == -1)
					{
					document.getElementById("disable").disabled = true;
					}
				else if(this.response.currentStatus == 0)
					{
					document.getElementById("disable").disabled = false;
					}
                Console.log(this.response.message);
            };
        });

        Chat.initialize = function () {
            if (window.location.protocol == 'http:') {
                Chat.connect('ws://qa.taxometry.com:8080/service/websocket/chat');
				 //Chat.connect('ws://qa.taxometry.com/service/websocket/chat');
            } else {
                Chat.connect('wss://qa.taxometry.com:443/service/websocket/chat');
				//Chat.connect('ws://qa.taxometry.com/service/websocket/chat');
            }
        };

        Chat.sendMessage = (function () {
            var message = document.getElementById('chat').value;
            if (message != '') {
                Chat.socket.send(message);
                document.getElementById('chat').value = '';
            }
        });

        var Console = {};

        Console.log = (function (message) {
            var console = document.getElementById('console');
            var p = document.createElement('p');
            p.style.wordWrap = 'break-word';
            p.innerHTML = message;
            console.appendChild(p);
            while (console.childNodes.length > 25) {
                console.removeChild(console.firstChild);
            }
            console.scrollTop = console.scrollHeight;
        });

        Chat.initialize();


        document.addEventListener("DOMContentLoaded", function () {
            // Remove elements with "noscript" class - <noscript> is not allowed in XHTML
            var noscripts = document.getElementsByClassName("noscript");
            for (var i = 0; i < noscripts.length; i++) {
                noscripts[i].parentNode.removeChild(noscripts[i]);
            }
        }, false);

    ]]>
    </script>

</head>

<body>

    <div class="container">
        <div class="noscript">
		
            <h2 style="color: #ff0000">Seems your browser doesn't support Javascript! Websockets rely on Javascript being enabled. Please enable Javascript
                and reload this page!</h2>
        </div>
        <div>
            <!--<p>
                <input type="text" placeholder="type and press enter to chat" id="chat" />
            </p>-->
<div class="heading">
<h3 class="text-center">Logs for Rates, Boundary, TaxMatrix</h3>
</div>

            <!-- <button class="fastreload" id="chat">ForceReloadRates</button>
     <button class="updaterate" id="chat2">UpdateRates</button> -->
            <div class="col-md-12">
                <div class="col-md-4"></div>
                <div class="col-md-2">
                                   <select id="disable" name="navyOp" onchange="test(this);">
  <option selected="selected"></option>
  <option value="Rates">Rates</option>
  <option value="Boundary">Boundary</option>
  <option value="TaxMatrix">TaxMatrix</option>
   <option value="Force Rates">Force Rates</option>
  <option value="Force Boundary">Force Boundary</option>
  <option value="Force TaxMatrix">Force TaxMatrix</option>
</select>
               
                </div>
                
                <div class="col-md-2">

                    <!-- Trigger the modal with a button -->
                    <button style="width:159px" type="button" class="btn btn-primary " data-toggle="modal" data-target="#myModal">Scheduler</button>

                    <!-- Modal -->
                    <div class="modal fade" id="myModal" role="dialog">
                        <div class="modal-dialog modal-md">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal"></button>
                                    <h4 class="modal-title">Scheduler</h4>
                                </div>
                                <div class="modal-body">
								<div class="row">
                                    <div class="col-md-12">
                                        <div class="col-md-6">
										<h4>Recurrences</h4>
                                            <div class="radio">
                                                <label><input type="radio" id="daily" name="optradio"/>Daily</label>
                                            </div>
                                            <div class="radio">
                                                <label><input type="radio" id="weekly" name="optradio"/>Weekly</label>
                                            </div>
                                            <div class="radio ">
                                                <label><input type="radio" id="monthly" name="optradio" />Monthly</label>
                                            </div>
                                            <div class="radio ">
                                                <label><input type="radio" id="yearly" name="optradio" />Yearly</label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
										<h4>Range Of Recurrences</h4>
										
										 <div id="weekrange" style="display:none">
										<!--  <label class="radio-inline"><input type="radio" name="optradio"/>Sunday</label>
										 <label class="radio-inline"><input type="radio" name="optradio"/>Monday</label>
										 <label class="radio-inline"><input type="radio" name="optradio"/>Tuesday</label>
										 <label style="margin-left:0" class="radio-inline"><input type="radio" name="optradio"/>Wednesday</label>
										 <label style="margin-left:0" class="radio-inline"><input type="radio" name="optradio"/>Thursday</label>
										 <label class="radio-inline"><input type="radio" name="optradio"/>Friday</label>
										 <label style="margin-left:0" class="radio-inline"><input type="radio" name="optradio"/>Saturday</label> -->
										 <h5>Select Day</h5>
										 <select name="weeks" id="weekoption" class="form-control">
											<option value="0">select</option>
											<option value="1">Sunday</option>
											<option value="2">Monday</option>
											<option value="3">Tuesday</option>
											<option value="4">Wednesday</option>
											<option value="5">Thursday</option>
											<option value="6">Friday</option>
											<option value="7">Saturday</option>
										</select>
										 </div>
										 <div id= "daterange">
										<h5>Start Date</h5>
										<input type = "text" placeholder="mm-dd-yy" class="form-control" id = "datepicker-3"/>
										 <!-- <input type="date" placeholder="Starting time" class="form-control"/> -->
										 </div>
										 <div id= "timerange">
										<h5>Start Time</h5>
										  <div class='input-group date' id='datetimepicker3'>
                    <input type='text' placeholder="hh:mm:ss" id="timevalue" class="form-control" />
                    <span class="input-group-addon">
                        <span class="glyphicon glyphicon-time"></span>
                    </span>
                </div>
										 <!-- <input type="time" placeholder="Starting time" class="form-control"/> -->
										 </div>
										</div>
                                    </div>
								</div>
                                </div>
                                <div class="modal-footer">
								<div class="btncontainer">
									 <button style="width:159px" id="scheduler" class="btn btn-primary" type="button">Schedule</button>
                                    <button style="width:159px" type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
									</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-12">
                <div id="console-container">
                    <div id="console" />
                </div>
            </div>
        </div>
    </div>
</body>

</html>